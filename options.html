<html>
  <head>
    <style>
        body {text-align: center; padding-top: 50px; font-family: sans-serif;color: grey; }
        #regexp {border: solid #ddd 1px; height: 28px}
        #main {border: 1px solid #ddd; padding: 15px; width: 35%;background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#fff), to(#ddd));}
        .helptxt {font-size: x-small; color: #999;}
        .error {border: 2px solid red;}
    </style>
    <script>
        var MAX_DEPTH = 5;

        function $(id) {
            return document.getElementById(id);
        }

        function save() {
            localStorage["__regexp__"] = $("regexp").value;
            localStorage["__regexpcase__"] = $("regexpcase").checked;
            localStorage["__newtab__"] = $("newtab").checked;
            
            var md = parseInt($("maxDepth").value); 
            if(md > 0 && md <= MAX_DEPTH) {
                localStorage["__depth__"] = md;
            } else {
                $("maxDepth").className = "error";
                return;
            }
            
            window.close();
        }

        function loadOptions() {
            var re = localStorage["__regexp__"];
            var reCase = localStorage["__regexpcase__"];
            var newTab = localStorage["__newtab__"];
            var maxDepth = localStorage["__depth__"] || MAX_DEPTH;
            
            $("regexp").value = (re ? re : "^\\\[%s.*\\\]");
            $("regexpcase").checked = (reCase == "true" ? true : false);
            $("newtab").checked = (newTab == "true" ? true : false);
            $("maxDepth").value = maxDepth;
            $("range").innerHTML = maxDepth;
        }

    </script>

    <title>Bookmark Keyword Options</title>
    <body onload="loadOptions()">
        <center>
        <div id="title">
            <h2>Bookmark Keyword Options</h2>
        </div>
        <div id="main"> 
            <div>Regular Expression:<input type="text" id="regexp">
            <i class="helptxt">
                <p>Enter regular expression that represents the keyword part of the bookmark title.</p>
                <p>For example the default expression looks for title in following format: <b>[keyword] Title</b></p>
                <p>%s represents the search string.</p>
            </i>
            </div>
            <div>
                <p>Case Sensitive: <input type="checkbox" id="regexpcase"><p>
            </div>
            <div>
                <p>Open in New Tab: <input type="checkbox" id="newtab"></p>
            </div>
            <div>
                <p>Max. Suggestions: <input type="range" id="maxDepth" min="1" max="5" onchange="$('range').innerHTML = this.value">
                <br/><span id="range"></span></i>
            </div>
            <br/><br/>
            <div><input type="button" id="saveBtn" onclick="save()" value="Save Options"/>
        </div>
        </center>
    </body>
</head>
</html>
